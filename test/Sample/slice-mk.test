#!/usr/bin/python
# -*- mode:python; coding:utf-8; tab-width:4 -*-

import os

def addprefix(prefix, names):
    return [os.path.join(prefix, f) for f in names]


Test(desc = "Compile slices lib", 
     cmd = "make -I $fullbasedir -C $testdir/slice", 
     shell = True,
     gen = addprefix("$testdir/slice/Sample",
                     ["Hello.h", "Hello.o",
                      "Bye.h",   "Bye.o",
                      "libSampleSlice.la"]))

Test(desc = "Compile a client using slice lib",
     cmd = "make -C $testdir/src",
     gen = ["$testdir/src/client.o",
            "$testdir/src/client"])

Test(desc = "Install lib and headers",
     env = {"DESTDIR": "/tmp/slice-mk"},
     cmd = "make -I $fullbasedir -C $testdir/slice install",
     gen = addprefix("/tmp/slice-mk/usr", 
                     ["lib/libSampleSlice.la",
                      "include/Sample/Hello.h",
                      "include/Sample/Bye.h"]))








     
